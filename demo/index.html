<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PDF Editor Demo</title>

    <!-- 样式：直接复用现有 viewer 样式，确保分页/图层/编辑器正常显示 -->
    <link rel="stylesheet" href="../web/pdf_viewer.css" />
    <link rel="stylesheet" href="../web/text_layer_builder.css" />
    <link rel="stylesheet" href="../web/annotation_layer_builder.css" />
    <link rel="stylesheet" href="../web/annotation_editor_layer_builder.css" />
    <link rel="stylesheet" href="../web/xfa_layer_builder.css" />

    <!-- Import Map：指向仓库内 src/ 与 web/ 模块（ESM） -->
    <script type="importmap">
      {
        "imports": {
          "pdfjs/": "../src/",
          "pdfjs-lib": "../src/pdf.js",

          "display-cmap_reader_factory": "../src/display/cmap_reader_factory.js",
          "display-standard_fontdata_factory": "../src/display/standard_fontdata_factory.js",
          "display-wasm_factory": "../src/display/wasm_factory.js",
          "display-fetch_stream": "../src/display/fetch_stream.js",
          "display-network": "../src/display/network.js",
          "display-node_stream": "../src/display/stubs.js",
          "display-node_utils": "../src/display/stubs.js",

          "web-null_l10n": "../web/genericl10n.js"
        }
      }
    </script>

    <style>
      body { margin: 0; font: 14px/1.4 -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif; }
      .toolbar { display: flex; gap: 8px; align-items: center; padding: 8px; border-bottom: 1px solid #e5e5e5; }
      .toolbar button { padding: 6px 10px; }
      .toolbar .spacer { flex: 1; }
      #viewerContainer { position: absolute; inset: 48px 0 0 0; overflow: auto; }
      #viewer { }
      .mode-group { display: flex; gap: 6px; align-items: center; }
      .mode-group button[aria-pressed="true"] { background: #0070f3; color: white; }
      .page-ctrls { display: inline-flex; gap: 6px; align-items: center; }
      input[type="number"] { width: 64px; }
      .hidden { display: none; }
    </style>
  </head>
  <body>
    <div class="toolbar">
      <label>
        <input id="fileInput" type="file" accept="application/pdf" class="hidden" />
        <button id="openBtn" type="button">打开文件</button>
      </label>

      <div class="mode-group" role="radiogroup" aria-label="编辑工具">
        <button id="modeSelect" type="button" aria-pressed="true" title="选择/浏览">选择</button>
        <button id="modeFreeText" type="button" aria-pressed="false" title="文本注释">文本</button>
        <button id="modeHighlight" type="button" aria-pressed="false" title="高亮">高亮</button>
        <button id="modeInk" type="button" aria-pressed="false" title="手写">手写</button>
        <button id="modeStamp" type="button" aria-pressed="false" title="印章/图像">印章</button>
        <button id="modeSignature" type="button" aria-pressed="false" title="签名">签名</button>
      </div>

      <div class="page-ctrls">
        <button id="prevPage" type="button">上一页</button>
        <input id="pageNumber" type="number" min="1" value="1" />
        <span>/ <span id="numPages">1</span></span>
        <button id="nextPage" type="button">下一页</button>
      </div>

      <div class="spacer"></div>

      <button id="zoomOut" type="button">-</button>
      <button id="zoomIn" type="button">+</button>
      <button id="saveBtn" type="button">保存/下载</button>
    </div>

    <div id="viewerContainer">
      <div id="viewer" class="pdfViewer"></div>
    </div>

    <script type="module" src="./web/app.js"></script>
  </body>
  </html>

